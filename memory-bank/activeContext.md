# アクティブコンテキスト

## 現在の作業フォーカス

### メモリーバンク機能の実装
現在、プロジェクトの主要機能の一つであるメモリーバンク機能の実装に取り組んでいます。メモリーバンクは、プロジェクトの知識を構造化して保存し、コンテキストを維持するための重要なコンポーネントです。

#### 実装中の要素
1. **メモリーエントリのデータモデル**
   - メモリーエントリの型定義
   - カテゴリと関連性の構造化

2. **メモリーコンテキスト**
   - メモリーエントリの状態管理
   - CRUD操作の実装

3. **メモリーバンクUI**
   - メモリーエントリの表示コンポーネント
   - 作成・編集フォーム
   - カテゴリ別表示

4. **ワークフローとの統合**
   - ワークフロー実行時のメモリー参照
   - コンテキスト共有メカニズム

### ワークフローエディタの機能強化
並行して、ワークフローエディタの機能強化にも取り組んでいます。特に、ブロック間の接続機能とワークフロー実行エンジンの開発を進めています。

### コードベースの整理と最適化
プロジェクトの成長に伴い、コードベースの整理と最適化も進めています。特に、招待機能に関連するファイルの整理と統合を行い、重複コードの削除と機能の明確化を図っています。

## 最近の変更

### メモリーバンクの基盤構築
1. **メモリーバンクディレクトリの作成**
   - プロジェクトドキュメントを構造化して保存するためのディレクトリ構造を確立
   - コアファイル（projectbrief.md, productContext.md, systemPatterns.md, techContext.md, activeContext.md, progress.md）の作成と内容の充実

2. **メモリーバンクの初期コンテンツ作成**
   - プロジェクト概要の文書化
   - プロダクトコンテキストの定義
   - システムパターンの記述
   - 技術スタックとコンテキストの整理

### コードベースの整理
1. **開発ツールの整理**
   - `public/dev-tools/` ディレクトリの作成
   - 開発・デバッグ用HTMLファイルの整理と分類
   - カテゴリ別（データベース、認証、デバッグ）の整理

2. **APIルートの整理**
   - 一時的な修正スクリプトのバックアップと削除
   - テスト用APIの整理

3. **マイグレーションファイルの統合**
   - 招待テーブル関連のマイグレーションを統合
   - RLSポリシー関連のマイグレーションを統合
   - より包括的で一貫性のあるマイグレーションファイルの作成

### 進行中の開発
1. **メモリーコンポーネントの設計**
   - `src/components/memory/MemoryBank.tsx`の設計
   - `src/components/memory/MemoryCard.tsx`の設計
   - `src/components/memory/MemoryForm.tsx`の設計

2. **メモリーコンテキストの設計**
   - `src/contexts/MemoryContext.tsx`の設計
   - メモリーエントリのCRUD操作の計画

3. **メモリー型定義の設計**
   - `src/types/memory.ts`の設計
   - メモリーエントリとその関連型の定義の計画

## 次のステップ

### 短期的なタスク
1. **メモリーバンクコンポーネントの実装**
   - メモリーエントリの型定義ファイルの作成
   - メモリーコンテキストの実装
   - メモリーバンクUIコンポーネントの実装

2. **メモリーバンクUIの開発**
   - メモリーエントリの表示と編集機能の実装
   - カテゴリフィルタリングの実装
   - 検索機能の追加

3. **永続化機能の実装**
   - ローカルストレージへのメモリーエントリの保存
   - 読み込み機能の実装

4. **チャットインターフェースとの統合**
   - チャット中にメモリーエントリを参照する機能
   - コンテキスト認識型の応答生成

5. **統合されたマイグレーションの適用**
   - 新しいマイグレーションファイルの適用
   - 招待機能の動作確認

### 中期的な目標
1. **メモリーバンクの高度な機能**
   - 関連エントリの自動提案
   - タグベースのナビゲーション
   - メモリーエントリのバージョン管理

2. **ワークフロー統合の強化**
   - ワークフローステップとメモリーエントリの関連付け
   - コンテキストベースのワークフロー提案
   - ワークフロー実行時のメモリー参照機能

3. **AIアシスタントの強化**
   - メモリーバンクを活用した高度なコンテキスト理解
   - パーソナライズされた支援機能
   - 継続的な学習と改善のメカニズム

## 重要な決定事項

### アーキテクチャの決定
1. **メモリーバンクの構造**
   - マークダウン形式でのドキュメント管理
   - 階層的なファイル構造による情報整理
   - コアファイルとコンテキスト固有ファイルの分離

2. **状態管理アプローチ**
   - React Context APIを使用した状態管理
   - メモリーエントリのCRUD操作の一元管理
   - コンポーネント間でのコンテキスト共有

3. **UIデザインの方針**
   - カード形式でのメモリーエントリ表示
   - カテゴリベースのナビゲーション
   - インラインでの編集機能
   - レスポンシブデザインの採用

4. **コードベース整理の方針**
   - 開発ツールとプロダクションコードの明確な分離
   - マイグレーションファイルの統合による一貫性の確保
   - バックアップを取りながらの安全な整理

### 技術的な選択
1. **データ形式**
   - メモリーエントリの構造化JSONデータ
   - マークダウン形式のコンテンツ
   - メタデータによる関連性の表現

2. **永続化戦略**
   - 初期段階ではローカルストレージを使用
   - 将来的にはサーバーサイドストレージへの移行を検討
   - エクスポート/インポート機能の提供

3. **コンポーネント設計**
   - 再利用可能なコンポーネントの作成
   - 明確な責任分担
   - プロップドリリングを避けるためのコンテキスト活用

## 学びと洞察

### 技術的な学び
1. **Next.js App Routerの活用**
   - ページ構造とルーティングの効率的な管理
   - サーバーコンポーネントとクライアントコンポーネントの適切な使い分け
   - 動的ルーティングの効果的な活用

2. **TypeScriptの型安全性**
   - 厳格な型定義によるバグの早期発見
   - インターフェースを通じたコンポーネント間の契約
   - 型推論の活用による開発効率の向上

3. **React Context APIのパターン**
   - 効率的な状態管理と更新
   - コンテキストの分離と責任の明確化
   - パフォーマンスを考慮したコンテキスト設計

4. **コードベース管理の重要性**
   - 定期的な整理と最適化の必要性
   - 技術的負債の早期解消
   - 明確なディレクトリ構造とファイル命名規則の重要性

### プロジェクトの洞察
1. **ユーザー中心設計の重要性**
   - メモリーバンクのユーザビリティに焦点
   - 情報アクセスと管理の簡素化
   - ユーザーの作業フローに合わせた機能設計

2. **モジュール性と拡張性**
   - 独立したコンポーネントとコンテキスト
   - 将来の機能拡張を考慮した設計
   - 明確なインターフェースによる依存関係の管理

3. **継続的改善の実践**
   - 段階的な機能実装
   - フィードバックループの確立
   - 反復的な改善プロセス
   - ドキュメント駆動開発の効果

4. **メモリーバンクの重要性**
   - プロジェクトコンテキストの維持における役割
   - 知識の構造化と再利用の促進
   - 継続的な改善サイクルの支援

5. **コードベース整理の効果**
   - 開発効率の向上
   - メンテナンス性の改善
   - 新機能追加の容易化
   - チーム間の知識共有の促進
